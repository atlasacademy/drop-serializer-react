(this["webpackJsonpdrop-serializer-react"]=this["webpackJsonpdrop-serializer-react"]||[]).push([[0],{106:function(e,t,s){},109:function(e,t,s){},111:function(e,t,s){"use strict";s.r(t);var n=s(0),o=s.n(n),i=s(17),r=s.n(i),a=s(8),l=s(22),c=s(43),d=s(60),p=s(67),u=s(25),h=s(114),j=s(64),m=s(18),b=s(45),v=s(21),g=s.n(v);const O="drop-serializer/INIT_STATE",x="drop-serializer/LOAD_SESSION",y=()=>({type:x}),w="drop-serializer/LOAD_SETTINGS",S="drop-serializer/LOAD_SUBMISSION_QUEUE",f="drop-serializer/QUEUE_SUBMISSION",D="drop-serializer/PUSH_MESSAGE",N=(e,t)=>({type:D,payload:{type:e,message:t}}),C="drop-serializer/RESET_SUBMISSION",_="drop-serializer/SELECT_EVENT",E=e=>({type:_,payload:e}),I="drop-serializer/SELECT_NODE",z="drop-serializer/SET_EVENT_LIST",T="drop-serializer/SET_EVENT_DATA",M=e=>({type:T,payload:e}),L="drop-serializer/SET_SHOW_FILTERS",k="drop-serializer/SET_SHOW_SETTINGS",U=e=>({type:k,payload:e}),P="drop-serializer/SET_SHOW_UPLOAD",F=e=>({type:P,payload:e}),A="drop-serializer/SET_SUBMISSION_PENDING",q=e=>({type:A,payload:e}),Q="drop-serializer/SHIFT_MESSAGES",B="drop-serializer/SHIFT_SUBMISSIONS",R=()=>({type:B}),G="drop-serializer/UPDATE_DROP",J="drop-serializer/UPDATE_LOADING",W=e=>({type:J,payload:e}),H="drop-serializer/UPDATE_SETTING";var Y=s(63),K=s.n(Y);const V=(e,t)=>(s,n)=>{const{enableQueryParameters:o}=n().dropSerializer;if(!o)return;let i=window.location,r=new URLSearchParams(i.search);e?r.set("event",e):r.delete("event"),t?r.set("node",t):r.delete("node");let a=i.protocol+"//"+i.host+i.pathname+"?"+r.toString();window.history.replaceState({path:a},"",a)},$=e=>(t,s)=>{const{eventData:n}=s().dropSerializer;return e?Promise.resolve().then((()=>t(E(e)))).then((()=>t(V(e,!1)))).then((()=>t(W(!0)))).then((()=>t(M(null)))).then((()=>t(ie()))).then((()=>t(W(!1)))):Promise.resolve().then((()=>t(E(e)))).then((()=>t(V(!1,!1)))).then((()=>t(M(null))))},X=e=>(t,s)=>{const{selectedEvent:n}=s().dropSerializer;return Promise.resolve().then((()=>t({type:I,payload:e}))).then((()=>t(V(n,e)))).then((()=>t(y())))},Z=()=>(e,t)=>{const{eventData:s,selectedEvent:n,selectedNode:o,settings:i,submissionDrops:r}=t().dropSerializer,a=s.node_drops.filter((e=>e.event_node_uid===o)),l=i?i.submitter_name:"";let c=a.map((e=>{let t=r.filter((t=>t.uid===e.uid&&t.quantity===e.quantity)).shift();return t||(t={uid:e.uid,quantity:e.quantity,count:0,ignored:!1}),t})),d={event_uid:n,event_node_uid:o,submitter:l,drops:c,token:K()()};return Promise.resolve().then((()=>e({type:f,payload:d}))).then((()=>e({type:C}))).then((()=>e(ee())))},ee=()=>(e,t)=>{const{submissionQueue:s,submissionPending:n}=t().dropSerializer;if(n)return;if(!s.length)return;let o=s[0];return e(te(o))},te=e=>(t,s)=>{const{event_uid:n}=e,{domain:o}=s().dropSerializer;return Promise.resolve().then((()=>t(q(!0)))).then((()=>g.a.post(o+"/submit/run",e))).then((e=>Promise.resolve().then((()=>t(N("success","Created submission: "+e.data.receipt)))).then((()=>t(R()))).then((()=>t(q(!1)))).then((()=>t(se(n,e.data.missing_drops)))).then((()=>t(ee()))))).catch((e=>422===e.response.status?Promise.resolve().then((()=>t(N("danger","Submission rejected")))).then((()=>t(R()))).then((()=>t(q(!1)))).then((()=>t(ee()))):Promise.resolve().then((()=>t(N("warning","Issue during submission. Retrying ...")))).then((()=>new Promise((e=>{window.setTimeout(e,5e3)})))).then((()=>t(q(!1)))).then((()=>t(ee())))))},se=(e,t)=>(s,n)=>{const{selectedEvent:o,selectedNode:i}=n().dropSerializer;return t?e!==o?Promise.resolve():Promise.resolve().then((()=>s(N("info","Event data is outdated. Refreshing now ...")))).then((()=>s($("")))).then((()=>s($(o)))).then((()=>s(X(i)))):Promise.resolve()},ne=e=>{let t={domain:"https://submissions.atlasacademy.io",enableEventSelector:!0,enableQueryParameters:!0,messageKey:0,messages:[],nodeSave:[],selectedEvent:"",selectedNode:"",selectedDropUid:null,selectedDropQuantity:null,selectedDropInitialCount:null,settings:{},showFilters:!1,showSettings:!1,showUpload:!1,submissionPending:!1,submissionQueue:[],...e};if(t.enableQueryParameters){let e=new URLSearchParams(window.location.search);t.selectedEvent||(t.selectedEvent=e.has("event")?e.get("event"):""),t.selectedEvent&&!t.selectedNode&&(t.selectedNode=e.has("node")?e.get("node"):"")}return(e,s)=>Promise.resolve().then((()=>e({type:O,payload:t}))).then((()=>e(W(!0)))).then((()=>e({type:w}))).then((()=>e(oe()))).then((()=>e(ie()))).then((()=>e(y()))).then((()=>e({type:S}))).then((()=>(e(ee()),Promise.resolve()))).then((()=>""===s().dropSerializer.settings.submitter_name?e(U(!0)):Promise.resolve())).then((()=>e(W(!1))))},oe=()=>(e,t)=>{const{domain:s,enableEventSelector:n}=t().dropSerializer;if(n)return g.a.get(s+"/event").then((t=>{return e((s=t.data,{type:z,payload:s}));var s}))},ie=()=>(e,t)=>{const{domain:s,selectedEvent:n}=t().dropSerializer;if(n)return g.a.get(s+"/event/"+n).then((t=>e(M(t.data))))};s(106);var re=s(10),ae=s(1);class le extends o.a.Component{render(){return this.props.eventLoaded?Object(ae.jsx)("a",{href:this.props.sheetLink,className:"text-success",target:"_blank",rel:"noopener noreferrer author",children:Object(ae.jsx)(m.a,{variant:"outline-success",children:Object(ae.jsx)(re.FontAwesomeIcon,{icon:"file-excel"})})}):null}}var ce=Object(a.connect)((e=>{const{eventData:t,eventList:s}=e.dropSerializer,n=s&&s.length>0&&Boolean(t);return{eventLoaded:n,sheetLink:"https://docs.google.com/spreadsheets/d/"+(n?t.sheet_id:"")}}))(le);class de extends o.a.Component{constructor(e){super(e),this.state={delay:1e3,disabled:!1,timeout:null}}componentWillUnmount(){this.state.timeout&&(window.clearTimeout(this.state.timeout),this.setState({timeout:null}))}render(){return Object(ae.jsxs)(m.a,{variant:"success",block:!0,disabled:this.state.disabled,onClick:e=>this.submit(),children:[Object(ae.jsx)("img",{className:"chest-icon",src:"assets/chest.png",alt:""})," ",this.props.dropCount,"\xa0 - \xa0",Object(ae.jsx)(re.FontAwesomeIcon,{icon:"copy"})," Submit Run"]})}submit(){this.props.dispatch(Z()),this.setState({disabled:!0,timeout:window.setTimeout((()=>{this.setState({disabled:!1,timeout:null})}),this.state.delay)})}}var pe=Object(a.connect)((e=>{const t=e.dropSerializer.eventData.drops;return{dropCount:e.dropSerializer.submissionDrops.map((e=>{if(e.ignored)return 0;let s=t.filter((t=>t.uid===e.uid)).shift();return s&&"Bonus Rate-Up"===s.type?0:e.count})).reduce(((e,t)=>e+t),0)}}))(de);class ue extends o.a.Component{render(){return Object(ae.jsxs)(m.a,{variant:"primary",block:!0,onClick:e=>this.onClick(e),children:[Object(ae.jsx)(re.FontAwesomeIcon,{icon:"filter"})," Toggle Filter"]})}onClick(e){var t;this.props.dispatch((t=!this.props.showFilters,{type:L,payload:t}))}}var he=Object(a.connect)((e=>{const{showFilters:t}=e.dropSerializer;return{showFilters:t}}))(ue);function je(e,t){let{nodeDrop:s}=t,{eventData:n,selectedDropUid:o,selectedDropQuantity:i,selectedDropInitialCount:r,settings:a,showFilters:l,submissionDrops:c}=e.dropSerializer,d=n.drops.filter((e=>e.uid===s.uid)).shift(),p=s.quantity>1?s.quantity:d.quantity,u=c.filter((e=>e.uid===s.uid&&e.quantity===s.quantity)).shift();return void 0===u&&(u={uid:s.uid,quantity:s.quantity,count:0,ignored:!1}),{drop:d,nodeDrop:s,quantityDisplay:p,selectedDropUid:o,selectedDropQuantity:i,selectedDropInitialCount:r,submissionDrop:u,settings:a,showFilters:l}}function me(e,t){return{update:(s,n)=>e(((e,t,s,n)=>({type:G,payload:{uid:e,quantity:t,count:s,ignored:n}}))(t.nodeDrop.uid,t.nodeDrop.quantity,s,n))}}var be={connect:Object(a.connect)(je,me),mapDispatchToProps:me,mapStateToProps:je},ve=s(7);class ge extends o.a.Component{render(){return Object(ae.jsx)(ve.a.Control,{type:"text",className:"drop-input",value:this.props.submissionDrop.count,onChange:e=>this.onChange(e),size:"sm"})}onChange(e){let t=parseInt(e.target.value);(isNaN(t)||t<0)&&(t=0),this.props.update(t,!1)}}var Oe=be.connect(ge);const xe=new(s(65).Howl)({src:"./sounds/click.mp3"});class ye extends o.a.Component{constructor(e,t){super(e);const s={delay:250,iteratorSkip:2,max:void 0,min:0,step:1,windowLeash:10};this.incrementorSettings={...s,...t},this.state={interval:null,iterator:0,running:!1,windowPosition:null,windowListener:null}}componentWillUnmount(){this.stopInterval()}onMouseDown(e){this.state.running||this.startInterval()}onMouseMove(e){}onMouseOut(e){this.state.running&&this.stopInterval()}onMouseUp(e){this.state.running&&(this.state.iterator<=this.incrementorSettings.iteratorSkip&&this.stepCount(),this.stopInterval())}onWindowScroll(e){if(!this.state.running)return;Math.abs(window.scrollY-this.state.windowPosition)>this.incrementorSettings.windowLeash&&this.stopInterval()}stepCount(){let e=this.props.submissionDrop.count+this.incrementorSettings.step;e<this.incrementorSettings.min?e=this.incrementorSettings.min:void 0!==this.incrementorSettings.max&&e>this.incrementorSettings.max&&(e=this.incrementorSettings.max),this.props.update(e,!1),this.props.parent.animate(),this.props.settings.click&&xe.play(),this.props.settings.vibrate&&window.navigator.vibrate&&window.navigator.vibrate(100)}startInterval(){let e=setInterval((()=>this.tick()),this.incrementorSettings.delay),t=window.scrollY,s=e=>this.onWindowScroll(e);window.addEventListener("scroll",s),this.setState({iterator:0,running:!0,interval:e,windowListener:s,windowPosition:t})}stopInterval(){this.state.running&&(clearInterval(this.state.interval),window.removeEventListener("scroll",this.state.windowListener),this.setState({running:!1,interval:null,windowListener:null,windowPosition:null}))}tick(){this.state.iterator>this.incrementorSettings.iteratorSkip&&this.stepCount(),this.setState({iterator:this.state.iterator+1})}}var we=ye;function Se(e,t){const{parent:s}=t;return{...be.mapStateToProps(e,t),parent:s}}const fe=be.mapDispatchToProps;var De={connect:Object(a.connect)(Se,fe),mapDispatchToProps:fe,mapStateToProps:Se};var Ne=De.connect(class extends we{constructor(e){super(e,{delay:250,iteratorSkip:2,step:-1,windowLeash:10})}render(){return Object(ae.jsx)(m.a,{variant:"primary",block:!0,size:"sm",tabIndex:"-1",onMouseDown:e=>this.onMouseDown(e),onMouseMove:e=>this.onMouseMove(e),onMouseOut:e=>this.onMouseOut(e),onMouseUp:e=>this.onMouseUp(e),children:Object(ae.jsx)(re.FontAwesomeIcon,{icon:"minus"})})}});var Ce=De.connect(class extends we{constructor(e){super(e,{delay:250,iteratorSkip:2,step:1,windowLeash:10})}render(){return Object(ae.jsx)("img",{className:"drop-icon",draggable:"false",src:this.props.drop.image,alt:this.props.drop.name,onMouseDown:e=>this.onMouseDown(e),onMouseMove:e=>this.onMouseMove(e),onMouseOut:e=>this.onMouseOut(e),onMouseUp:e=>this.onMouseUp(e)})}});class _e extends o.a.Component{render(){return this.props.showFilters?Object(ae.jsx)("div",{className:"drop-toggle",onClick:e=>this.onClick(e),children:Object(ae.jsx)(re.FontAwesomeIcon,{className:"drop-toggle-icon",icon:this.props.submissionDrop.ignored?"ban":"check"})}):null}onClick(e){this.props.update(0,!this.props.submissionDrop.ignored)}}var Ee=be.connect(_e);class Ie extends o.a.Component{render(){let e=this.props.selectedDropUid===this.props.nodeDrop.uid&&this.props.selectedDropQuantity===this.props.nodeDrop.quantity,t=e?this.props.submissionDrop.count-this.props.selectedDropInitialCount:0,s=(t>=0?"+":"-")+(e?Math.abs(t).toString():"");return Object(ae.jsx)("span",{className:"drop-indicator",children:s})}}var ze=be.connect(Ie);class Te extends o.a.Component{constructor(e){super(e),this.state={animating:!1}}render(){return this.props.submissionDrop.ignored&&!this.props.showFilters?null:Object(ae.jsx)("div",{className:"drop "+this.props.settings.columns+(this.state.animating?" animating":""),children:Object(ae.jsxs)("div",{className:"drop-border",children:[Object(ae.jsxs)("div",{className:"drop-content",children:[Object(ae.jsxs)("div",{className:"drop-icon-box",children:[Object(ae.jsx)(Ce,{nodeDrop:this.props.nodeDrop,parent:this}),Object(ae.jsx)(ze,{nodeDrop:this.props.nodeDrop}),Object(ae.jsx)("span",{className:"drop-quantity",children:this.props.quantityDisplay>1?this.props.quantityDisplay.toLocaleString():""})]}),Object(ae.jsx)(Oe,{nodeDrop:this.props.nodeDrop}),Object(ae.jsx)(Ne,{nodeDrop:this.props.nodeDrop,parent:this})]}),Object(ae.jsx)(Ee,{nodeDrop:this.props.nodeDrop})]})})}animate(){this.setState({animating:!0}),setTimeout((()=>this.setState({animating:!1})),1)}}var Me=be.connect(Te);class Le extends o.a.Component{render(){return Object(ae.jsx)(ve.a.Control,{as:"select",className:"drop-input",value:this.props.submissionDrop.count,onChange:e=>this.props.update(parseInt(e.target.value),!1),size:"sm",children:[...Array(5).keys()].map((e=>Object(ae.jsxs)("option",{value:25*e,children:[25*e,"%"]},e)))})}}var ke=be.connect(Le);var Ue=De.connect(class extends we{constructor(e){super(e,{max:100,step:25})}render(){return Object(ae.jsx)("img",{className:"drop-icon",draggable:"false",src:this.props.drop.image,alt:this.props.drop.name,onMouseDown:e=>this.onMouseDown(e),onMouseMove:e=>this.onMouseMove(e),onMouseOut:e=>this.onMouseOut(e),onMouseUp:e=>this.onMouseUp(e)})}});var Pe=De.connect(class extends we{constructor(e){super(e,{max:100,step:-25})}render(){return Object(ae.jsx)(m.a,{variant:"primary",block:!0,size:"sm",tabIndex:"-1",onMouseDown:e=>this.onMouseDown(e),onMouseMove:e=>this.onMouseMove(e),onMouseOut:e=>this.onMouseOut(e),onMouseUp:e=>this.onMouseUp(e),children:Object(ae.jsx)(re.FontAwesomeIcon,{icon:"minus"})})}});class Fe extends o.a.Component{constructor(e){super(e),this.state={animating:!1}}render(){return Object(ae.jsx)("div",{className:"drop drop-bonus "+this.props.settings.columns+(this.state.animating?" animating":""),children:Object(ae.jsx)("div",{className:"drop-border",children:Object(ae.jsxs)("div",{className:"drop-content",children:[Object(ae.jsxs)("div",{className:"drop-icon-box",children:[Object(ae.jsx)(Ue,{nodeDrop:this.props.nodeDrop,parent:this}),Object(ae.jsx)("span",{className:"drop-indicator",children:"Bonus"})]}),Object(ae.jsx)(ke,{nodeDrop:this.props.nodeDrop}),Object(ae.jsx)(Pe,{nodeDrop:this.props.nodeDrop,parent:this})]})})})}animate(){this.setState({animating:!0}),setTimeout((()=>this.setState({animating:!1})),1)}}var Ae=be.connect(Fe);class qe extends o.a.Component{render(){const e=function(e){return e.event_uid+"_"+e.event_node_uid+"_"+e.uid+"_"+e.quantity};return Object(ae.jsx)("div",{className:"drop-container",children:this.props.nodeDrops.map(((t,s)=>this.props.drops[s]&&"Bonus Rate-Up"===this.props.drops[s].type?Object(ae.jsx)(Ae,{nodeDrop:t},e(t)):Object(ae.jsx)(Me,{nodeDrop:t},e(t))))})}}var Qe=Object(a.connect)((e=>{const{selectedNode:t}=e.dropSerializer,s=e.dropSerializer.eventData.node_drops.filter((e=>e.event_node_uid===t));return{drops:s.map((t=>e.dropSerializer.eventData.drops.filter((e=>e.uid===t.uid)).shift())),nodeDrops:s}}))(qe),Be=s(35);class Re extends o.a.Component{componentDidMount(){window.setTimeout((()=>{this.props.dispatch({type:Q})}),5e3)}render(){return Object(ae.jsx)(Be.a,{variant:this.props.message.type,children:this.props.message.message})}}var Ge=Object(a.connect)()(Re);class Je extends o.a.Component{render(){return 0===this.props.pendingCount?null:Object(ae.jsxs)(Be.a,{variant:"warning",children:[this.props.pendingCount," pending submission(s)."]})}}var We=Object(a.connect)((e=>{let{submissionQueue:t}=e.dropSerializer;return{pendingCount:void 0===t?0:t.length}}))(Je);class He extends o.a.Component{render(){return Object(ae.jsxs)("div",{className:"Messages",children:[Object(ae.jsx)(We,{}),this.props.messages.map((e=>Object(ae.jsx)(Ge,{message:e},e.key)))]})}}var Ye=Object(a.connect)((e=>{let{messages:t}=e.dropSerializer;return void 0===t&&(t=[]),{messages:t}}))(He);class Ke extends o.a.Component{render(){return Object(ae.jsx)(ve.a.Control,{as:"select",className:"event-selector",onChange:e=>this.updateEvent(e),value:this.props.selectedEvent,children:[Object(ae.jsx)("option",{value:"",children:"Select a event"},0)].concat(this.props.eventList.map(((e,t)=>Object(ae.jsx)("option",{value:e.uid,children:e.name},t+1))))})}updateEvent(e){this.props.dispatch($(e.target.value))}}var Ve=Object(a.connect)((e=>({selectedEvent:e.dropSerializer.selectedEvent,eventList:e.dropSerializer.eventList})))(Ke);class $e extends o.a.Component{render(){return Object(ae.jsx)(ve.a.Control,{as:"select",className:"event-selector",onChange:e=>{this.updateNode(e)},value:this.props.selectedNode,children:[Object(ae.jsx)("option",{value:"",children:"Select a node"},0)].concat(this.props.nodeList.map(((e,t)=>Object(ae.jsx)("option",{value:e.uid,children:e.name},t+1))))})}updateNode(e){this.props.dispatch(X(e.target.value))}}var Xe=Object(a.connect)((e=>({nodeList:e.dropSerializer.eventData.nodes,selectedNode:e.dropSerializer.selectedNode})))($e),Ze=s(19);function et(e,t){let{property:s}=t,{settings:n}=e.dropSerializer;return{property:s,value:n[s]}}function tt(e,t){return{update:s=>e(((e,t)=>({type:H,payload:{property:e,value:t}}))(t.property,s))}}var st={connect:Object(a.connect)(et,tt),mapDispatchToProps:tt,mapStateToProps:et},nt=st.connect((function(e){let{property:t,value:s,update:n}=e;return Object(ae.jsxs)(ve.a.Group,{controlId:"settingPlayClick",children:[Object(ae.jsx)(ve.a.Label,{children:"Play Click"}),Object(ae.jsxs)(ve.a.Control,{as:"select",value:s?"Yes":"No",onChange:e=>n("Yes"===e.target.value),children:[Object(ae.jsx)("option",{children:"Yes"}),Object(ae.jsx)("option",{children:"No"})]})]})})),ot=st.connect((function(e){let{property:t,value:s,update:n}=e;return Object(ae.jsxs)(ve.a.Group,{controlId:"settingNumberOfColumns",children:[Object(ae.jsx)(ve.a.Label,{children:"Number of Columns"}),Object(ae.jsxs)(ve.a.Control,{as:"select",value:s,onChange:e=>n(e.target.value),children:[Object(ae.jsx)("option",{value:"columns_auto",children:"Auto"}),Object(ae.jsx)("option",{value:"columns_2",children:"2"}),Object(ae.jsx)("option",{value:"columns_4",children:"4"}),Object(ae.jsx)("option",{value:"columns_6",children:"6"}),Object(ae.jsx)("option",{value:"columns_8",children:"8"}),Object(ae.jsx)("option",{value:"columns_12",children:"12"}),Object(ae.jsx)("option",{value:"columns_16",children:"16"})]})]})})),it=st.connect((function(e){let{property:t,value:s,update:n}=e;return Object(ae.jsxs)(ve.a.Group,{controlId:"settingSubmitterName",children:[Object(ae.jsx)(ve.a.Label,{children:"Submitter Name"}),Object(ae.jsx)(ve.a.Control,{value:s,onChange:e=>n(e.target.value)})]})})),rt=st.connect((function(e){let{property:t,value:s,update:n}=e;return Object(ae.jsxs)(ve.a.Group,{controlId:"settingVibrate",children:[Object(ae.jsx)(ve.a.Label,{children:"Vibrate"}),Object(ae.jsxs)(ve.a.Control,{as:"select",value:s?"Yes":"No",disabled:!window.navigator.vibrate,onChange:e=>n("Yes"===e.target.value),children:[Object(ae.jsx)("option",{children:"Yes"}),Object(ae.jsx)("option",{children:"No"})]})]})})),at=st.connect((function(e){let{property:t,value:s,update:n}=e;return Object(ae.jsxs)(ve.a.Group,{controlId:"settingAppWidth",children:[Object(ae.jsx)(ve.a.Label,{children:"App Width"}),Object(ae.jsxs)(ve.a.Control,{as:"select",value:s,onChange:e=>n(e.target.value),children:[Object(ae.jsx)("option",{value:"width_full",children:"Full Width"}),Object(ae.jsx)("option",{value:"width_480",children:"480px"}),Object(ae.jsx)("option",{value:"width_720",children:"720px"}),Object(ae.jsx)("option",{value:"width_1080",children:"1080p"}),Object(ae.jsx)("option",{value:"width_1200",children:"1200p"}),Object(ae.jsx)("option",{value:"width_1440",children:"1440p"}),Object(ae.jsx)("option",{value:"width_2160",children:"2160p"})]})]})}));const lt=["default","cerulean","cosmo","cyborg","darkly","flatly","journal","litera","lumen","lux","materia","minty","pulse","sandstone","simplex","sketchy","slate","solar","spacelab","superhero","united","yeti"];var ct=st.connect((function(e){let{property:t,value:s,update:n}=e;return Object(ae.jsxs)(ve.a.Group,{controlId:"settingAppTheme",children:[Object(ae.jsx)(ve.a.Label,{children:"Theme"}),Object(ae.jsx)(ve.a.Control,{as:"select",value:s,onChange:e=>n(e.target.value),children:lt.map((e=>Object(ae.jsx)("option",{value:"theme_".concat(e),children:e},e)))})]})}));function dt(e){let{showSettings:t}=e.dropSerializer;return{showSettings:t}}function pt(e){return{hide:()=>e(U(!1)),show:()=>e(U(!0)),toggle:()=>e(((e,t)=>{let{showSettings:s}=t().dropSerializer;return e(U(!s))}))}}var ut={connect:Object(a.connect)(dt,pt),mapDispatchToProps:pt,mapStateToProps:dt},ht=ut.connect((function(e){let{showSettings:t,show:s,hide:n}=e;return Object(ae.jsxs)(Ze.a,{show:t,onHide:e=>n(),children:[Object(ae.jsx)(Ze.a.Header,{closeButton:!0,children:Object(ae.jsx)(Ze.a.Title,{children:"Settings"})}),Object(ae.jsxs)(Ze.a.Body,{children:[Object(ae.jsx)(it,{property:"submitter_name"}),Object(ae.jsx)(at,{property:"width"}),Object(ae.jsx)(ot,{property:"columns"}),Object(ae.jsx)(ct,{property:"theme"}),Object(ae.jsx)(nt,{property:"click"}),Object(ae.jsx)(rt,{property:"vibrate"})]})]})})),jt=ut.connect((function(e){let{showSettings:t,show:s,hide:n}=e;return Object(ae.jsx)(m.a,{variant:"outline-danger",className:"settings",onClick:e=>s(e),children:Object(ae.jsx)(re.FontAwesomeIcon,{icon:"cog"})})}));class mt extends o.a.Component{toggle(){this.props.dispatch(F(!this.props.showUpload))}render(){return this.props.eventLoaded&&this.props.parsable&&this.props.selectedNode?Object(ae.jsx)("a",{href:"Upload drop screenshots",onClick:e=>{e.preventDefault(),this.toggle()},children:Object(ae.jsxs)(m.a,{variant:"outline-info",children:["Upload drop screenshots\xa0\xa0",Object(ae.jsx)(u.a,{icon:"file-upload"})]})}):null}}var bt=Object(a.connect)((e=>{const{eventData:t,eventList:s,selectedNode:n,showUpload:o}=e.dropSerializer,i=s&&s.length>0&&Boolean(t);return{eventLoaded:i,parsable:!!i&&t.parsable,selectedNode:n,showUpload:o}}))(mt),vt=s(113),gt=s(115);class Ot extends o.a.Component{constructor(e){super(e),this.state={downloading:!1,type:"simple",files:[]}}addFiles(e){const t=this.state.files.slice();for(let s=0;s<e.length;s++)t.push({file:e[s],completed:!1,failed:!1,progress:0});this.setState({files:t})}async download(){await this.setState({downloading:!0});let e=0;for(let t=0;t<this.state.files.length;t++){const s=this.state.files[t];if(!s.completed)for(e++,this.downloadFile(t,s).then((()=>{e--}));e>=5;)await new Promise((e=>setTimeout(e,100)))}for(;e>0;)await new Promise((e=>setTimeout(e,100)));await this.setState({downloading:!1})}async downloadFile(e,t){const s=this.props.domain+"/submit/screenshot";let n=[...this.state.files];n[e].failed=!1,n[e].progress=0,await this.setState({files:n});try{const o=new FormData;o.append("event_uid",this.props.selectedEvent),o.append("event_node_uid",this.props.selectedNode),o.append("submitter",this.props.submitter),o.append("type",this.state.type),o.append("files[]",t.file),await g.a.post(s,o,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:t=>{n=[...this.state.files],n[e].progress=t.loaded/t.total*100,this.setState({files:n})}}),n=[...this.state.files],n[e].completed=!0,await this.setState({files:n})}catch(o){n=[...this.state.files],n[e].failed=!0,await this.setState({files:n})}return!0}readyToUpload(){return!this.state.downloading&&this.state.files.length>0&&0===this.state.files.filter((e=>e.failed)).length&&this.state.files.filter((e=>!e.completed&&!e.failed)).length>0}readyToRetry(){return!this.state.downloading&&this.state.files.length>0&&this.state.files.filter((e=>e.failed)).length>0}isComplete(){return!this.state.downloading&&this.state.files.length>0&&0===this.state.files.filter((e=>!e.completed)).length}reset(){this.setState({files:[]})}hide(){this.state.downloading||(this.props.dispatch(F(!1)),this.reset())}render(){const e=/^\d+$/.test(this.props.selectedEvent);return Object(ae.jsxs)(Ze.a,{show:this.props.show,onHide:()=>this.hide(),children:[Object(ae.jsx)(Ze.a.Header,{closeButton:!0,children:Object(ae.jsx)(Ze.a.Title,{children:"Upload"})}),Object(ae.jsxs)(Ze.a.Body,{children:[this.state.downloading?null:Object(ae.jsxs)(ve.a,{children:[this.state.files.length?null:Object(ae.jsxs)("div",{children:[Object(ae.jsxs)(Be.a,{variant:"info",children:["Uploading to ",e?"event":""," ",Object(ae.jsx)("b",{children:this.props.selectedEventName})," ","node ",Object(ae.jsx)("b",{children:this.props.selectedNodeName})," ","as ",Object(ae.jsx)("b",{children:this.props.submitter})]}),Object(ae.jsxs)(ve.a.Group,{children:[Object(ae.jsx)(ve.a.Label,{children:"Type"}),Object(ae.jsxs)(ve.a.Control,{as:"select",value:this.state.type,onChange:e=>{this.setState({type:e.target.value})},children:[Object(ae.jsx)("option",{value:"simple",children:"Simple"}),Object(ae.jsx)("option",{value:"full",children:"Full"})]}),Object(ae.jsx)(ve.a.Text,{children:Object(ae.jsxs)("ul",{children:[Object(ae.jsx)("li",{children:"Simple: Only first screen. Currency + QP + Exp are ignored"}),Object(ae.jsx)("li",{children:"Full: All drop screens are required for submission to be successful"})]})})]}),Object(ae.jsxs)(ve.a.Group,{children:[Object(ae.jsx)(ve.a.Label,{children:"Files"}),Object(ae.jsxs)("div",{className:"custom-file",children:[Object(ae.jsx)("input",{type:"file",className:"custom-file-input",accept:"image/*",multiple:"multiple",onChange:e=>{this.addFiles(e.target.files)}}),Object(ae.jsx)("label",{className:"custom-file-label",children:"Select Files"})]})]})]}),this.readyToUpload()?Object(ae.jsx)(ve.a.Group,{children:Object(ae.jsxs)(vt.a,{className:"btn-block",children:[Object(ae.jsx)(m.a,{variant:"danger",onClick:()=>this.reset(),children:"Reset"}),Object(ae.jsx)(m.a,{onClick:()=>this.download(),children:"Upload All"})]})}):null,this.readyToRetry()?Object(ae.jsx)(ve.a.Group,{children:Object(ae.jsxs)(vt.a,{className:"btn-block",children:[Object(ae.jsx)(m.a,{variant:"danger",onClick:()=>this.reset(),children:"Reset"}),Object(ae.jsx)(m.a,{onClick:()=>this.download(),children:"Retry Failed"})]})}):null,this.isComplete()?Object(ae.jsxs)("div",{children:[Object(ae.jsx)("p",{children:"All Complete"}),Object(ae.jsx)(m.a,{block:!0,variant:"success",onClick:()=>this.reset(),children:"New Uploads"})]}):null]}),this.state.files.map(((e,t)=>e.completed?null:Object(ae.jsxs)("div",{children:[Object(ae.jsx)("h5",{children:e.file.name}),this.state.downloading&&!e.failed?Object(ae.jsx)(gt.a,{animated:!0,striped:!0,now:e.progress}):null,e.failed?Object(ae.jsx)("p",{className:"text-danger",children:"Failed"}):null,Object(ae.jsx)("br",{})]},t)))]})]})}}var xt=Object(a.connect)((e=>{var t,s,n,o;const{domain:i,selectedEvent:r,selectedNode:a,settings:l,showUpload:c,eventList:d,eventData:p}=e.dropSerializer,u=null!==(t=null===(s=(null!==d&&void 0!==d?d:[]).find((e=>e.uid===r)))||void 0===s?void 0:s.name)&&void 0!==t?t:"",h=null!==(n=null===p||void 0===p||null===(o=p.nodes.find((e=>e.uid===a)))||void 0===o?void 0:o.name)&&void 0!==n?n:"";return{domain:i,selectedEvent:r,selectedEventName:u,selectedNode:a,selectedNodeName:h,show:c,submitter:l.submitter_name}}))(Ot);class yt extends o.a.Component{componentDidMount(){this.props.dispatch(ne(this.props.options))}render(){var e;const t=(null!==(e=this.props.settings.theme)&&void 0!==e?e:"theme_default").replace("theme_","");return Object(ae.jsxs)(b.b,{children:[Object(ae.jsx)(b.a,{children:"default"===t?null:Object(ae.jsx)("link",{rel:"stylesheet",href:"https://cdn.jsdelivr.net/npm/bootswatch@4.6.0/dist/".concat(t,"/bootstrap.min.css")},"theme")}),Object(ae.jsxs)("div",{id:"drop-serializer",className:this.props.settings.width,children:[Object(ae.jsx)("div",{className:"title",children:Object(ae.jsxs)(h.a,{children:[Object(ae.jsx)(j.a,{md:12,lg:6,children:Object(ae.jsxs)("h1",{children:["Drop Serializer",Object(ae.jsxs)("small",{children:[" by ",Object(ae.jsx)("a",{href:"https://discord.gg/TKJmuCR",children:"Atlas Academy"})]})]})}),Object(ae.jsx)(j.a,{md:12,lg:6,children:Object(ae.jsxs)("div",{className:"links",children:[Object(ae.jsx)(bt,{}),Object(ae.jsx)(ce,{}),Object(ae.jsx)("a",{href:"https://github.com/atlasacademy/drop-serializer-react",className:"text-secondary",target:"_blank",rel:"noopener noreferrer author",children:Object(ae.jsx)(m.a,{variant:"outline-secondary",children:Object(ae.jsx)(u.a,{icon:["fab","github"]})})}),Object(ae.jsx)("a",{href:"https://discord.gg/TKJmuCR",className:"text-secondary",target:"_blank",rel:"noopener noreferrer author",children:Object(ae.jsx)(m.a,{variant:"outline-secondary",children:Object(ae.jsx)(u.a,{icon:["fab","discord"]})})}),Object(ae.jsx)(jt,{})]})})]})}),this.props.eventsLoaded&&Object(ae.jsx)(Ve,{}),this.props.eventLoaded&&Object(ae.jsx)(Xe,{}),this.props.nodeSelected&&Object(ae.jsxs)("div",{children:[Object(ae.jsx)(Qe,{}),Object(ae.jsxs)(h.a,{children:[Object(ae.jsx)(j.a,{children:Object(ae.jsx)(he,{})}),Object(ae.jsx)(j.a,{children:Object(ae.jsx)(pe,{})})]})]}),Object(ae.jsx)(ht,{}),Object(ae.jsx)(xt,{}),this.props.isLoading&&Object(ae.jsx)("div",{className:"loading",children:Object(ae.jsx)("div",{className:"loading-content",children:Object(ae.jsx)(u.a,{icon:"spinner",spin:!0})})}),Object(ae.jsx)(Ye,{})]})]})}}var wt=Object(a.connect)(((e,t)=>{const{eventData:s,eventList:n,isLoading:o,selectedEvent:i,selectedNode:r,settings:a}=e.dropSerializer,{options:l}=t,c=n&&n.length>0,d=c&&Boolean(s);return{eventsLoaded:c,eventLoaded:d,isLoading:o,nodeSelected:!o&&d&&Boolean(i)&&Boolean(r),options:l,settings:a}}))(yt);function St(e,t){switch(t.type){case O:return{...e,...t.payload};case x:{let{selectedEvent:t,selectedNode:s}=e,n=t+"_"+s,o=window.localStorage.getItem(n),i=null===o?[]:JSON.parse(o);return t&&s||(i=[]),{...e,submissionDrops:i}}case w:{let t={submitter_name:"",click:!0,columns:"columns_auto",vibrate:!0,width:"width_full",theme:"theme_default"},s=window.localStorage.getItem("settings"),n={...t,...null===s?[]:JSON.parse(s)};return{...e,settings:n}}case S:{let t=window.localStorage.getItem("submissions"),s=null===t?[]:JSON.parse(t);return{...e,submissionQueue:s}}case f:{let s=t.payload,{submissionQueue:n}=e;return n.push(s),window.localStorage.setItem("submissions",JSON.stringify(n)),{...e,submissionQueue:n}}case D:{let s=e.messageKey,n=[...e.messages,{...t.payload,key:s++}];return{...e,messageKey:s,messages:n}}case C:{let{selectedEvent:t,selectedNode:s}=e,n=t+"_"+s,o=e.eventData.drops,i=e.submissionDrops.map((e=>{let t=o.filter((t=>t.uid===e.uid)).shift();return t&&"Bonus Rate-Up"===t.type?e:{...e,count:0}}));return window.localStorage.setItem(n,JSON.stringify(i)),{...e,selectedDropUid:null,selectedDropQuantity:null,selectedDropInitialCount:null,submissionDrops:i}}case _:return{...e,selectedEvent:t.payload,selectedNode:""};case I:return{...e,selectedNode:t.payload};case z:return{...e,eventList:t.payload};case T:return{...e,eventData:t.payload};case L:return{...e,showFilters:t.payload};case k:return{...e,showSettings:t.payload};case P:return{...e,showUpload:t.payload};case A:return{...e,submissionPending:t.payload};case Q:{let t=e.messages.slice(1);return{...e,messages:t}}case B:{let t=e.submissionQueue.slice(1);return window.localStorage.setItem("submissions",JSON.stringify(t)),{...e,submissionQueue:t}}case G:{let{selectedEvent:s,selectedNode:n}=e,{uid:o,quantity:i,count:r,ignored:a}=t.payload,l=s+"_"+n,c=e.eventData.node_drops.filter((e=>e.event_node_uid===n)),d=e.submissionDrops.filter((e=>e.uid===o&&e.quantity===i)).shift(),p=c.map((t=>{let s=e.submissionDrops.filter((e=>e.uid===t.uid&&e.quantity===t.quantity)).shift();return void 0===s&&(s={uid:t.uid,quantity:t.quantity,count:0,ignored:!1}),s.uid===o&&s.quantity===i&&(s={...s,count:r,ignored:a}),s})),u={...e,submissionDrops:p};return window.localStorage.setItem(l,JSON.stringify(p)),e.selectedDropUid===o&&e.selectedDropQuantity===i||(u.selectedDropUid=o,u.selectedDropQuantity=i,u.selectedDropInitialCount=d?d.count:0),u}case J:return{...e,isLoading:t.payload};case H:{let s={...e},n={...s.settings};return n[t.payload.property]=t.payload.value,s.settings=n,window.localStorage.setItem("settings",JSON.stringify(n)),s}default:return void 0===e?{settings:{}}:e}}s(109);class ft extends o.a.Component{constructor(e){super(e),this.store=Object(c.createStore)({},[Object(l.applyMiddleware)(p.a)])}render(){return Object(ae.jsx)("div",{id:"app",children:Object(ae.jsx)(a.Provider,{store:this.store,children:Object(ae.jsx)(d.DynamicModuleLoader,{modules:[{id:"drop-serializer",reducerMap:{dropSerializer:St}}],children:Object(ae.jsx)(wt,{options:{domain:"https://submissions.atlasacademy.io",enableEventSelector:!0}})})})})}}var Dt=ft;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s(110);var Nt=s(9),Ct=s(16),_t=s(46);Nt.library.add(Ct.a),Nt.library.add(Ct.b),Nt.library.add(Ct.c),Nt.library.add(Ct.d),Nt.library.add(Ct.e),Nt.library.add(Ct.f),Nt.library.add(Ct.g),Nt.library.add(Ct.h),Nt.library.add(Ct.i),Nt.library.add(Ct.j),Nt.library.add(_t.a),Nt.library.add(_t.b),r.a.render(Object(ae.jsx)(Dt,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((e=>{e.unregister()}))}},[[111,1,2]]]);
//# sourceMappingURL=main.57add725.chunk.js.map