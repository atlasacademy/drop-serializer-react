(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{141:function(e,t){},143:function(e,t){},150:function(e,t,n){},152:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),i=n(17),a=n.n(i),s=(n(75),n(7)),c=n(8),u=n(12),l=n(11),d=n(13),v=n(18),m=n(20),p=n.n(m),h=n(69),f=n.n(h),g=n(19),w=function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,null,[{key:"clearNodeSession",value:function(t,n){var o=e.makeNodeSessionKey(t,n);window.localStorage.removeItem(o)}},{key:"getNodeSession",value:function(t,n){var o=e.makeNodeSessionKey(t,n),r=window.localStorage.getItem(o);return null===r?[]:JSON.parse(r)}},{key:"getSessionNodeDrop",value:function(t,n,o,r){var i=e.getNodeSession(t,n),a={uid:o,quantity:r,count:0,ignored:!1},s=i.filter(function(e){return e.uid===o&&e.quantity===r}).shift();return void 0===s?a:s}},{key:"getSubmitterName",value:function(){var e=window.localStorage.getItem("submitter_name");return null===e?"":e}},{key:"makeNodeSessionKey",value:function(e,t){return"event_"+e+"_node_"+t}},{key:"queueSubmission",value:function(e){var t=window.localStorage.getItem("submissions"),n=null===t?[]:JSON.parse(t);n.push(e),window.localStorage.setItem("submissions",JSON.stringify(n))}},{key:"setSessionNodeDrop",value:function(t,n,o,r,i,a){var s=e.makeNodeSessionKey(t,n),c=e.getNodeSession(t,n).filter(function(e){return e.uid!==o||e.quantity!==r});c.push({uid:o,quantity:r,count:i,ignored:a}),window.localStorage.setItem(s,JSON.stringify(c))}},{key:"setSubmitterName",value:function(e){window.localStorage.setItem("submitter_name",e)}}]),e}(),b=(n(79),n(14)),E=n.n(b),y=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).increment={interval:250,intervalSkips:3,iterator:0,pointerLeash:10,pointerX:null,pointerY:null,running:!1,timer:null,windowLeash:10,windowListener:null,windowPosition:null},n.state=w.getSessionNodeDrop(e.nodeDrop.event_uid,e.nodeDrop.event_node_uid,e.nodeDrop.uid,e.nodeDrop.quantity),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=r.a.createElement("img",{className:"DropIcon",draggable:"false",src:this.props.drop.image,alt:this.props.drop.name,onMouseDown:function(t){return e.startIncrement(t,1)},onMouseMove:function(t){return e.checkMouseMove(t)},onMouseOut:function(t){return e.stopIncrement()},onMouseUp:function(t){return e.doMouseUp(1)}}),n=r.a.createElement("span",{className:"DropIndicator"},"+"),o=this.props.nodeDrop.quantity>1?r.a.createElement("span",{className:"DropQuantity"},this.props.nodeDrop.quantity):"",i=r.a.createElement(E.a.Control,{type:"text",className:"DropInput form-control form-control-sm",value:this.state.count,onChange:function(t){return e.changeCount(t)}}),a=r.a.createElement(p.a,{variant:"primary",block:!0,size:"sm",className:"DropDecrement",onMouseDown:function(t){return e.startIncrement(t,-1)},onMouseMove:function(t){return e.checkMouseMove(t)},onMouseOut:function(t){return e.stopIncrement()},onMouseUp:function(t){return e.doMouseUp(-1)}},r.a.createElement(g.a,{icon:"minus"}));return r.a.createElement("div",{className:"Drop"},r.a.createElement("div",{className:"DropBorder"},r.a.createElement("div",{className:"DropContent"},r.a.createElement("div",{className:"DropIconBox"},t,n,o),i,a)))}},{key:"changeCount",value:function(e){this.setCount(e.target.value)}},{key:"checkMouseMove",value:function(e){if(this.increment.running){var t=e.clientX,n=e.clientY,o=Math.abs(t-this.increment.pointerX),r=Math.abs(n-this.increment.pointerY);(o>this.increment.pointerLeash||r>this.increment.pointerLeash)&&this.stopIncrement()}}},{key:"doMouseUp",value:function(e){this.increment.running&&(this.increment.iterator<=this.increment.intervalSkips&&this.setCount(this.state.count+e),this.stopIncrement())}},{key:"getState",value:function(){return this.state}},{key:"setCount",value:function(e){w.setSessionNodeDrop(this.props.nodeDrop.event_uid,this.props.nodeDrop.event_node_uid,this.props.nodeDrop.uid,this.props.nodeDrop.quantity,e,!1),this.setState(w.getSessionNodeDrop(this.props.nodeDrop.event_uid,this.props.nodeDrop.event_node_uid,this.props.nodeDrop.uid,this.props.nodeDrop.quantity))}},{key:"startIncrement",value:function(e,t){this.stopIncrement();var n=this;this.increment.iterator=0,this.increment.pointerX=e.clientX,this.increment.pointerY=e.clientY,this.increment.timer=setInterval(function(){n.increment.iterator>n.increment.intervalSkips&&n.setCount(n.state.count+t),n.increment.iterator++},this.increment.interval),this.increment.windowPosition=window.scrollY,this.increment.windowListener=function(e){Math.abs(window.scrollY-n.increment.windowPosition)>n.increment.windowLeash&&n.stopIncrement()},window.addEventListener("scroll",this.increment.windowListener),this.increment.running=!0}},{key:"stopIncrement",value:function(){this.increment.running&&(clearInterval(this.increment.timer),window.removeEventListener("scroll",this.increment.windowListener),this.increment.timer=null,this.increment.windowListener=null,this.increment.running=!1)}}]),t}(r.a.Component),S=(n(92),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).dropRefs=[],n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"Node"},r.a.createElement(p.a,{variant:"success",block:!0,onClick:function(t){return e.submit()}},r.a.createElement(g.a,{icon:"copy"})," Submit Run"),r.a.createElement("div",{className:"DropsContainer"},this.renderDrops()),r.a.createElement(p.a,{variant:"success",block:!0,onClick:function(t){return e.submit()}},r.a.createElement(g.a,{icon:"copy"})," Submit Run"),r.a.createElement(p.a,{variant:"danger",block:!0},r.a.createElement(g.a,{icon:"trash-alt"})," Reset Current Run"))}},{key:"renderDrops",value:function(){var e=this;return this.props.nodeDrops.map(function(t,n){var o=e.props.drops.filter(function(e){return e.uid===t.uid}).shift();return r.a.createElement(y,{key:n,nodeDrop:t,drop:o,ref:function(t){e.dropRefs.push(t)}})})}},{key:"submit",value:function(){var e={event_uid:this.props.node.event_uid,event_node_uid:this.props.node.uid,submitter:w.getSubmitterName(),drops:this.dropRefs.map(function(e){return e.getState()})};w.queueSubmission(e),w.clearNodeSession(this.props.node.event_uid,this.props.node.uid),this.dropRefs.forEach(function(e){e.setCount(0)})}}]),t}(r.a.Component)),k=function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,null,[{key:"get",value:function(t){return e.urlParams().has(t)?e.urlParams().get(t):""}},{key:"getEvent",value:function(){return e.get("event")}},{key:"getNode",value:function(){return e.get("node")}},{key:"setEvent",value:function(t){var n=e.urlParams();n.set("event",t),n.delete("node"),e.update("?"+n.toString())}},{key:"setNode",value:function(t){var n=e.urlParams();n.set("node",t),e.update("?"+n.toString())}},{key:"update",value:function(e){var t=window.location.protocol+"//"+window.location.host+window.location.pathname+e;window.history.replaceState({path:t},"",t)}},{key:"urlParams",value:function(){return new URLSearchParams(window.location.search)}}]),e}(),N=(n(93),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).selectNode=n.selectNode.bind(Object(v.a)(Object(v.a)(n))),n.state=n.extractNode(k.getNode()),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"extractNode",value:function(e){var t=this.props.event.nodes.filter(function(t){return t.uid===e}).pop(),n=this.props.event.node_drops.filter(function(t){return t.event_node_uid===e}).sort(function(e,t){return e.sort-t.sort}),o=f()(n.map(function(e){return e.uid})),r=this.props.event.drops.filter(function(e){return-1!==o.indexOf(e.uid)});return{selectedNode:e,node:t,nodeDrops:n,drops:r}}},{key:"render",value:function(){return r.a.createElement("div",{className:"Event"},this.renderNodeSelector(),this.renderNode())}},{key:"renderNode",value:function(){if(this.state.selectedNode)return r.a.createElement(S,{node:this.state.node,nodeDrops:this.state.nodeDrops,drops:this.state.drops})}},{key:"renderNodeSelector",value:function(){var e=0,t=[r.a.createElement("option",{key:e++,value:""},"Select a node")].concat(this.props.event.nodes.map(function(t){return r.a.createElement("option",{key:e++,value:t.uid},t.name)}));return r.a.createElement(E.a.Control,{as:"select",className:"NodeSelector custom-select",onChange:this.selectNode,value:this.state.selectedNode},t)}},{key:"selectNode",value:function(e){var t=e.target.value;k.setNode(t),this.setState(this.extractNode(t))}}]),t}(r.a.Component)),D=n(30),O=n.n(D),j=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={show:!1,submitter_name:w.getSubmitterName()},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(O.a,{show:this.state.show,onHide:function(t){return e.handleClose()}},r.a.createElement(O.a.Header,{closeButton:!0},r.a.createElement(O.a.Title,null,"Settings")),r.a.createElement(O.a.Body,null,r.a.createElement(E.a.Group,{controlId:"settingSubmitterName"},r.a.createElement(E.a.Label,null,"Submitter Name"),r.a.createElement(E.a.Control,{value:this.state.submitter_name,onChange:function(t){return e.setSubmitterName(t.target.value)}}))))}},{key:"handleClose",value:function(){this.setState({show:!1})}},{key:"setSubmitterName",value:function(e){w.setSubmitterName(e),this.setState({submitter_name:w.getSubmitterName()})}},{key:"toggle",value:function(){this.setState({show:!this.state.show})}}]),t}(r.a.Component),C="https://submissions.atlasacademy.io",I=n(131).XMLHttpRequest,L=function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,null,[{key:"getEvents",value:function(e){var t=new I;t.onload=function(){e(JSON.parse(t.responseText))},t.open("GET",C+"/event"),t.send()}},{key:"getEvent",value:function(e,t){var n=new I;n.onload=function(){t(JSON.parse(n.responseText))},n.open("GET",C+"/event/"+e),n.send()}}]),e}(),_=(n(150),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).selectEvent=n.selectEvent.bind(Object(v.a)(Object(v.a)(n))),n.state={isLoadingEvents:!0,isLoadingEvent:!0,eventsData:[],eventData:[],selectedEvent:k.getEvent()},L.getEvents(function(e){n.setState({isLoadingEvents:!1,eventsData:e}),n.state.selectedEvent&&L.getEvent(n.state.selectedEvent,function(e){n.setState({isLoadingEvent:!1,eventData:e})})}),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"AppTitle"},r.a.createElement("h1",null,"Drop Serializer",r.a.createElement("small",null,"by ",r.a.createElement("a",{href:"https://discord.gg/TKJmuCR"},"Atlas Academy"))),r.a.createElement(p.a,{variant:"info",className:"AppSettingsToggle",onClick:function(t){return e.setting.toggle()}},r.a.createElement(g.a,{icon:"cog"}))),this.renderEventSelector(),this.renderEvent(),r.a.createElement(j,{ref:function(t){e.setting=t},onChange:function(){e.refreshSettings()}}))}},{key:"renderEvent",value:function(){if(!this.state.isLoadingEvent&&this.state.selectedEvent)return r.a.createElement(N,{event:this.state.eventData,selected:this.state.selectedEvent})}},{key:"renderEventSelector",value:function(){if(!this.state.isLoadingEvents){var e=0,t=[r.a.createElement("option",{key:e++,value:""},"Select a event")].concat(this.state.eventsData.map(function(t){return r.a.createElement("option",{key:e++,value:t.uid},t.name)}));return r.a.createElement(E.a.Control,{as:"select",className:"EventSelector",onChange:this.selectEvent,value:this.state.selectedEvent},t)}}},{key:"refreshSettings",value:function(){}},{key:"selectEvent",value:function(e){var t=this,n=e.target.value;k.setEvent(n),this.setState({isLoadingEvent:!0,eventData:null,selectedEvent:n}),n&&L.getEvent(n,function(e){t.setState({isLoadingEvent:!1,eventData:e})})}}]),t}(o.Component)),M=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function R(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}n(151);var q=n(21),P=n(31);q.b.add(P.a),q.b.add(P.b),q.b.add(P.c),q.b.add(P.d),a.a.render(r.a.createElement(_,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat(".","/service-worker.js");M?(function(e,t){fetch(e).then(function(n){var o=n.headers.get("content-type");404===n.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):R(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):R(t,e)})}}()},70:function(e,t,n){e.exports=n(152)},75:function(e,t,n){},79:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){}},[[70,1,2]]]);
//# sourceMappingURL=main.a180b780.chunk.js.map